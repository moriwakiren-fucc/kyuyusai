<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>動画分岐再生</title>
  <style>
    body, html {
      margin: 0;
      padding: 0;
      height: 100%;
      background: black;
      overflow: hidden;
    }
    video {
      width: 100%;
      height: 100%;
      object-fit: cover; /* 画面いっぱいに表示 */
    }
  </style>
</head>
<body>
  <video id="player" autoplay></video>

  <script>
    const video = document.getElementById("player");

    // 動画の遷移ルールを定義
    const transitions = {
      "0.mp4": { L: "1_L.mp4", A: "1_R.mp4" },
      "1_L.mp4": { L: "2_L.mp4", A: "2_R.mp4" },
      "2_R.mp4": { L: "3_L.mp4", A: "3_R.mp4" }
    };

    let nextChoice = null; // 押されたキーを記録する

    // 最初の動画をロード
    playVideo("0.mp4");

    function playVideo(filename) {
      video.src = filename;
      video.play();
      nextChoice = null;
    }

    // キー入力を記録
    window.addEventListener("keydown", (e) => {
      if (e.key === "ArrowLeft" || e.key === "l" || e.key === "L") {
        nextChoice = "L";
      } else if (e.key === "ArrowRight" || e.key === "a" || e.key === "A") {
        nextChoice = "A";
      }
    });

    // 動画が終わった瞬間に次を再生
    video.addEventListener("ended", () => {
      const rule = transitions[video.src.split("/").pop()];
      if (rule && nextChoice && rule[nextChoice]) {
        playVideo(rule[nextChoice]);
      }
    });
  </script>
</body>
</html>

